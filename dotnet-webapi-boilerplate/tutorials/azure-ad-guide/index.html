<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var b=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,a=localStorage.getItem("theme");b&&a===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),b&&a==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),a==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=/main.aae4c7b7ad14836d545ed1c03cefab4356757ac1c23febbe74d71487da342d811d273cf6cb8005ef8ed19fa6e8bc2062c7d218861f0ded9885c9a26a7bea9168.css integrity="sha512-quTHt60Ug21UXtHAPO+rQ1Z1esHCP+u+dNcUh9o0LYEdJzz2y4AF747Rn6bovCBix9IYhh8N7ZiFyaJqe+qRaA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Setting up Azure AD Authentication - fullstackhero</title><meta name=description content="Setting up Azure AD Authentication with fullstackhero's Web API"><link rel=canonical href=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Setting up Azure AD Authentication"><meta property="og:description" content="Setting up Azure AD Authentication with fullstackhero's Web API"><meta property="og:url" content="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/"><meta property="og:site_name" content="fullstackhero"><meta property="article:published_time" content="2021-08-30T00:59:34+05:30"><meta property="article:modified_time" content="2023-04-08T16:14:57+05:30"><meta property="og:image" content="/fullstackhero.png"><meta property="og:image:alt" content="fullstackhero"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@codewithmukesh"><meta name=twitter:creator content="@iammukeshm"><meta name=twitter:title content="Setting up Azure AD Authentication"><meta name=twitter:description content="Setting up Azure AD Authentication with fullstackhero's Web API"><meta name=twitter:image content="/fullstackhero.png"><meta name=twitter:image:alt content="Setting up Azure AD Authentication"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"/#/schema/organization/1","name":"fullstackhero","url":"/","sameAs":["https://twitter.com/codewithmukesh","https://github.com/fullstackhero"],"logo":{"@type":"ImageObject","@id":"/#/schema/image/1","url":"/logo-fullstackhero.png","width":512,"height":512,"caption":"fullstackhero"},"image":{"@id":"/#/schema/image/1"}},{"@type":"WebSite","@id":"/#/schema/website/1","url":"/","name":"fullstackhero","description":"fullstackhero is an ambitious project to cater the needs of Developers and Organizations and helps reduce the development hours by over 200\u002b hours!","publisher":{"@id":"/#/schema/organization/1"}},{"@type":"WebPage","@id":"/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/","url":"/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/","name":"Setting up Azure AD Authentication","description":"Setting up Azure AD Authentication with fullstackhero\u0027s Web API","isPartOf":{"@id":"/#/schema/website/1"},"about":{"@id":"/#/schema/organization/1"},"datePublished":"2021-08-30T00:59:34CET","dateModified":"2023-04-08T16:14:57CET","breadcrumb":{"@id":"/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/"]}]},{"@type":"BreadcrumbList","@id":"/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/","url":"/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"/dotnet-webapi-boilerplatetutorialsazure-ad-guide/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/#/schema/image/2","url":"/fullstackhero.png","contentUrl":"/fullstackhero.png","caption":"Setting up Azure AD Authentication"}]}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=/site.webmanifest></head><body class="dotnet-webapi-boilerplate single"><div class="alert alert-primary text-lg-center" role=alert>.NET 7 WebAPI Boilerplate Released üöÄüòÅ <a target=_blank class=alert-link href=https://fullstackhero.net/dotnet-webapi-boilerplate/general/getting-started/>Click here to get started! üòé‚òï</a></div><header class="navbar navbar-expand-md navbar-light doks-navbar sticky-lg-top"><nav class="container-fluid flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=/ aria-label=fullstackhero><img src=/images/navbar-logo.png alt="FullStackHero Logo" style=max-width:40px>
fullstack<b style=font-weight:600>hero</b></a>
<button class="btn btn-menu d-block d-md-none order-5" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="d-none d-xl-block"><form class="doks-search position-relative flex-grow-1 me-auto order-md-1" style=margin-left:15px><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form></div><div class="offcanvas offcanvas-start border-0 py-md-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="offcanvas-header d-md-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/><img src=/images/navbar-logo.png alt="FullStackHero Logo" style=max-width:40px>
fullstack<b style=font-weight:600>hero</b></a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body px-4"><ul class="nav flex-column flex-md-row ms-md-n3"><li class=nav-item><a class="nav-link py-1" href=/basics/getting-started/>Basics</a></li><li class=nav-item><a class="nav-link py-1" href=/dotnet-webapi-boilerplate/general/getting-started/>.NET 7 API üî•</a></li><li class=nav-item><a class="nav-link py-1" href=/dotnet-microservices-boilerplate/>Microservices (soon)</a></li><li class=nav-item><a class="nav-link py-1" href=/blazor-webassembly-boilerplate/general/getting-started/>Blazor</a></li><li class=nav-item><a class="nav-link py-1" href=/contact/>Contact</a></li></ul><hr class="text-black-50 my-4 d-md-none"><h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3><ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-2"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/fullstackhero><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://twitter.com/iammukeshm><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-md-none">Twitter</small></a></li></ul></div></div><button id=mode class="btn btn-link order-md-1" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></nav></header><nav class="doks-subnavbar py-2 d-lg-none sticky-lg-top" aria-label="Secondary navigation"><div class="container-fluid d-flex align-items-md-center"><form class="doks-search position-relative flex-grow-1 me-auto"><input id=search class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><button class="btn doks-sidebar-toggle d-lg-none ms-3 order-3 collapsed" type=button data-bs-toggle=collapse data-bs-target=#doks-docs-nav aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle documentation navigation"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></button></div></nav><div class=container-fluid><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2 nav-topic-header">General</h3><ul class=list-unstyled><li><a class=docs-link href=/dotnet-webapi-boilerplate/general/overview/>Overview</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/general/development-environment/>Development Environment</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/general/getting-started/>Getting Started üöÄ</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/general/api-testing/>API Testing</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/general/makefile-commands/>MakeFile Commands</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/general/project-structure/>Project Structure</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/general/changelogs/>Changelogs</a></li></ul><h3 class="h6 text-uppercase mb-2 nav-topic-header">Fundamentals</h3><ul class=list-unstyled><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/configurations/>Configurations</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/exception-handling/>Exception Handling</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/localization/>Localization</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/application-startup/>Application Startup</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/caching/>Caching</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/cors/>CORS</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/hangfire/>Hangfire</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/logging/>Logging</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/mail-service/>Mail Service</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/middlewares/>Middlewares</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/multitenancy/>Multitenancy</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/security/>Security</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/signalr/>SignalR</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/swagger/>Swagger</a></li></ul><h3 class="h6 text-uppercase mb-2 nav-topic-header">Tutorials</h3><ul class=list-unstyled><li><a class="docs-link active" href=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/>Azure AD Authentication</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/tutorials/database-migrations/>Database Migrations</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/tutorials/crud-guide/>Implementing CRUD</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/tutorials/deploying-to-iis/>Deploying to IIS</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/tutorials/deploying-to-azure/>Deploying to Azure AppService</a></li></ul></nav></aside></div><div class="wrap container-fluid" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2 nav-topic-header">General</h3><ul class=list-unstyled><li><a class=docs-link href=/dotnet-webapi-boilerplate/general/overview/>Overview</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/general/development-environment/>Development Environment</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/general/getting-started/>Getting Started üöÄ</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/general/api-testing/>API Testing</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/general/makefile-commands/>MakeFile Commands</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/general/project-structure/>Project Structure</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/general/changelogs/>Changelogs</a></li></ul><h3 class="h6 text-uppercase mb-2 nav-topic-header">Fundamentals</h3><ul class=list-unstyled><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/configurations/>Configurations</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/exception-handling/>Exception Handling</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/localization/>Localization</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/application-startup/>Application Startup</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/caching/>Caching</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/cors/>CORS</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/hangfire/>Hangfire</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/logging/>Logging</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/mail-service/>Mail Service</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/middlewares/>Middlewares</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/multitenancy/>Multitenancy</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/security/>Security</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/signalr/>SignalR</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/fundamentals/swagger/>Swagger</a></li></ul><h3 class="h6 text-uppercase mb-2 nav-topic-header">Tutorials</h3><ul class=list-unstyled><li><a class="docs-link active" href=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/>Azure AD Authentication</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/tutorials/database-migrations/>Database Migrations</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/tutorials/crud-guide/>Implementing CRUD</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/tutorials/deploying-to-iis/>Deploying to IIS</a></li><li><a class=docs-link href=/dotnet-webapi-boilerplate/tutorials/deploying-to-azure/>Deploying to Azure AppService</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><section class="section section-sm bg-light" style=padding:0><div style=padding-left:20px;padding-right:20px;padding-bottom:10px;margin-bottom:20px;padding-top:20px;margin-top:20px><h6 style=margin-top:0>SUPPORT THE PROJECT</h6><p style=font-size:.9375rem>Here is what you can do to show your support!</p><a class="btn btn-primary btn-lg px-4 mb-2" style=font-size:medium href=https://www.buymeacoffee.com/codewithmukesh target=_blank role=button>Buy me
a Coffee ‚òï</a>
<a class="btn btn-primary btn-lg px-4 mb-2" style=font-size:medium href=https://opencollective.com/fullstackhero/contribute target=_blank role=button>Sponsor üòç</a></div></section><section class="section section-sm bg-light" style=padding:0><div style=padding-left:20px;padding-right:20px;padding-bottom:10px;margin-bottom:20px class=page-links><h3>Contents On this page</h3><nav id=TableOfContents><ul><li><a href=#create-the-fshapi-application-registration>Create the FSHApi Application Registration</a><ul><li><a href=#expose-the-api>Expose the Api</a></li><li><a href=#add-app-roles>Add App roles</a></li></ul></li><li><a href=#assign-app-roles-to-specific-users-in-azuread>Assign App roles to specific users in AzureAD</a></li><li><a href=#create-the-client-application-registration>Create the Client Application Registration</a><ul><li><a href=#add-permission-for-the-api>Add permission for the Api</a></li><li><a href=#add-blazor-client-application>Add Blazor Client application</a></li></ul></li><li><a href=#update-the-azuread-settings-on-the-web-api-project>Update the AzureAd settings on the Web Api project</a></li><li><a href=#update-the-azuread-settings-on-the-blazor-client-project>Update the AzureAd settings on the Blazor Client project</a></li><li><a href=#configuration-for-postman>Configuration for Postman</a></li><li><a href=#test-it-out>Test it out</a></li><li><a href=#azuread-and-multitenancy>AzureAd and multitenancy</a></li><li><a href=#azuread-usersroles-vs-local-usersroles>AzureAd users/roles vs. local users/roles</a></li></ul></nav></div></section></nav><main class="docs-content col-lg-11 col-xl"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=/dotnet-webapi-boilerplate/>.NET Web API Boilerplate</a></li><li class=breadcrumb-item><a href=/dotnet-webapi-boilerplate/tutorials/>Tutorials</a></li><li class="breadcrumb-item active" aria-current=page>Setting up Azure AD Authentication</li></ol></nav><h1>Setting up Azure AD Authentication</h1><div class=views style=margin-bottom:20px><span class=views><img src="https://api.visitorbadge.io/api/visitors?path=%2fdotnet-webapi-boilerplate%2ftutorials%2fazure-ad-guide%2f&label=Views&labelColor=%233eaf7c&countColor=%231b1f22&style=flat-square"></span>
<span class=views><a href=https://discord.gg/gdgHRt4mMw target=_blank><img src="https://img.shields.io/discord/878181478972928011?color=%233eaf7c&label=Discord&logo=discord&logoColor=%233eaf7c&style=flat-square"></a></span>
<span class=views><a href=https://github.com/fullstackhero target=_blank><img src="https://img.shields.io/github/stars/fullstackhero?label=fullstackhero github ‚≠ê&style=flat-square&color=%233eaf7c"></a></span></div><span class=views><a href=https://github.com/fullstackhero/dotnet-webapi-boilerplate target=_blank><img src="https://img.shields.io/github/stars/fullstackhero/dotnet-webapi-boilerplate?label=dotnet-webapi-boilerplate github ‚≠ê&style=flat-square&color=%233eaf7c"></a></span><p><p class=lead>Setting up Azure AD Authentication with fullstackhero's Web API</p><nav class=d-xl-none aria-label="Quaternary navigation"><section class="section section-sm bg-light" style=padding:0><div style=padding-left:20px;padding-right:20px;padding-bottom:10px;margin-bottom:20px;padding-top:20px;margin-top:20px><h6 style=margin-top:0>SUPPORT THE PROJECT</h6><p style=font-size:.9375rem>Here is what you can do to show your support!</p><a class="btn btn-primary btn-lg px-4 mb-2" style=font-size:medium href=https://www.buymeacoffee.com/codewithmukesh target=_blank role=button>Buy me
a Coffee ‚òï</a>
<a class="btn btn-primary btn-lg px-4 mb-2" style=font-size:medium href=https://opencollective.com/fullstackhero/contribute target=_blank role=button>Sponsor üòç</a></div></section><section class="section section-sm bg-light" style=padding:0><div style=padding-left:20px;padding-right:20px;padding-bottom:10px;margin-bottom:20px class=page-links><h3>Contents On this page</h3><nav id=TableOfContents><ul><li><a href=#create-the-fshapi-application-registration>Create the FSHApi Application Registration</a><ul><li><a href=#expose-the-api>Expose the Api</a></li><li><a href=#add-app-roles>Add App roles</a></li></ul></li><li><a href=#assign-app-roles-to-specific-users-in-azuread>Assign App roles to specific users in AzureAD</a></li><li><a href=#create-the-client-application-registration>Create the Client Application Registration</a><ul><li><a href=#add-permission-for-the-api>Add permission for the Api</a></li><li><a href=#add-blazor-client-application>Add Blazor Client application</a></li></ul></li><li><a href=#update-the-azuread-settings-on-the-web-api-project>Update the AzureAd settings on the Web Api project</a></li><li><a href=#update-the-azuread-settings-on-the-blazor-client-project>Update the AzureAd settings on the Blazor Client project</a></li><li><a href=#configuration-for-postman>Configuration for Postman</a></li><li><a href=#test-it-out>Test it out</a></li><li><a href=#azuread-and-multitenancy>AzureAd and multitenancy</a></li><li><a href=#azuread-usersroles-vs-local-usersroles>AzureAd users/roles vs. local users/roles</a></li></ul></nav></div></section></nav><p>For the Azure AD integration to work with this template, you have to create 2 <code>App Registrations</code> under your Azure AD tenant with the right settings, and then fill out the <code>AzureAd</code> section in <code>Configurations/security.json</code> to hook those apps up. This guide will walk you through doing all that.</p><h2 id=create-the-fshapi-application-registration>Create the FSHApi Application Registration <a href=#create-the-fshapi-application-registration class=anchor aria-hidden=true>#</a></h2><ul><li><p>Log into the azure portal and go to the <a href=https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade>Azure Active Directory blade</a>. Make sure you are in the directory where you want your apps to be registered. You can switch directories by clicking on your account info in the top right corner.</p></li><li><p>Under <code>Manage</code>, click on <code>App registrations</code>, and click the <code>New registration</code> button on top:<figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_20x0_resize_box_3.png data-srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_400x0_resize_box_3.png 400w" width=906 height=595><noscript><img class=img-fluid sizes=100vw srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration_hufab59fda526ebd0068b3059bb1e970fb_46177_400x0_resize_box_3.png 400w" src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/new-registration.png width=906 height=595></noscript></figure></p></li><li><p>Fill in <code>FSHApi</code> (or whichever name you want for this app) as <code>Name</code>. Under <code>Supported account types</code> select <code>Accounts in any organizational directory - Multitenant</code> and click on <code>Register</code>:<figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_20x0_resize_box_3.png data-srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_400x0_resize_box_3.png 400w" width=845 height=566><noscript><img class=img-fluid sizes=100vw srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_400x0_resize_box_3.png 400w" src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api.png width=845 height=566></noscript></figure></p></li></ul><h3 id=expose-the-api>Expose the Api <a href=#expose-the-api class=anchor aria-hidden=true>#</a></h3><ul><li><p>On the newly created App&rsquo;s blade, under <code>Manage</code>, click on <code>Expose an API</code>, then click on <code>Add a scope</code>:<figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_20x0_resize_box_3.png data-srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_400x0_resize_box_3.png 400w" width=890 height=568><noscript><img class=img-fluid sizes=100vw srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1_hu802e1da739294b48e8662efd5630fed6_38390_400x0_resize_box_3.png 400w" src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-1.png width=890 height=568></noscript></figure></p></li><li><p>An <code>Application ID URI</code>q will automatically be filled out. Click on <code>Save and continue</code>:<figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_20x0_resize_box_3.png data-srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_400x0_resize_box_3.png 400w" width=580 height=284><noscript><img class=img-fluid sizes=100vw srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2_hud2b1b880fd5c0454afd53a55d6c1e11c_11182_400x0_resize_box_3.png 400w" src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-2.png width=580 height=284></noscript></figure></p></li><li><p>On the next screen, fill in <code>access_as_user</code> as <code>Scope name</code>, select <code>Admins and users</code> as <code>Who can consent?</code> and fill out the display names and descriptions like in the screenshot below, then click on <code>Add scope</code>:<figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-3_hua3fea6d7066e01b6afd2485087512915_22548_20x0_resize_box_3.png data-srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-3_hua3fea6d7066e01b6afd2485087512915_22548_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-3_hua3fea6d7066e01b6afd2485087512915_22548_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-3_hua3fea6d7066e01b6afd2485087512915_22548_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-3_hua3fea6d7066e01b6afd2485087512915_22548_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-3_hua3fea6d7066e01b6afd2485087512915_22548_100x0_resize_box_3.png 100w" width=577 height=670><noscript><img class=img-fluid sizes=100vw srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-3_hua3fea6d7066e01b6afd2485087512915_22548_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-3_hua3fea6d7066e01b6afd2485087512915_22548_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-3_hua3fea6d7066e01b6afd2485087512915_22548_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-3_hua3fea6d7066e01b6afd2485087512915_22548_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-3_hua3fea6d7066e01b6afd2485087512915_22548_100x0_resize_box_3.png 100w" src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-scope-3.png width=577 height=670></noscript></figure></p></li></ul><h3 id=add-app-roles>Add App roles <a href=#add-app-roles class=anchor aria-hidden=true>#</a></h3><ul><li><p>Under <code>Manage</code>, click on <code>App roles</code> and click the <code>Create app role</code> button on top:<figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_20x0_resize_box_3.png data-srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_400x0_resize_box_3.png 400w" width=899 height=505><noscript><img class=img-fluid sizes=100vw srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1_hu6513f0c8ba2e0c6aff6e02cfa16f5f76_27706_400x0_resize_box_3.png 400w" src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-1.png width=899 height=505></noscript></figure></p></li><li><p>Fill in <code>Administrators</code> as Display name and <code>Admin</code> as value. Especially the value is important, as this has to match the name of the role in the FSH application itself. Click on Apply:<figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_20x0_resize_box_3.png data-srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_400x0_resize_box_3.png 400w" width=584 height=568><noscript><img class=img-fluid sizes=100vw srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2_hud55b01dae692884065a2503a1c2de549_16291_400x0_resize_box_3.png 400w" src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/create-app-role-2.png width=584 height=568></noscript></figure></p></li><li><p>In the same way, create app roles for the other roles in your application (by default the only other role is the <code>Basic</code> role).</p></li></ul><h2 id=assign-app-roles-to-specific-users-in-azuread>Assign App roles to specific users in AzureAD <a href=#assign-app-roles-to-specific-users-in-azuread class=anchor aria-hidden=true>#</a></h2><p>You will have to assign those freshly created App roles to the AzureAd users to which you want to grant access to your application:</p><ul><li><p>On the <a href=https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade>Azure Active Directory blade</a>, under <code>Manage</code> click on <code>Enterprise applications</code> and select the FSHApi application:<figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_20x0_resize_box_3.png data-srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_400x0_resize_box_3.png 400w" width=936 height=586><noscript><img class=img-fluid sizes=100vw srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1_hu6885f31c7964f0fdf1e873cb9677ad5d_43328_400x0_resize_box_3.png 400w" src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-1.png width=936 height=586></noscript></figure></p></li><li><p>Under <code>Manage</code>, click on <code>Users and groups</code> and click the <code>Add user/group</code> button on top:<figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_20x0_resize_box_3.png data-srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_400x0_resize_box_3.png 400w" width=949 height=372><noscript><img class=img-fluid sizes=100vw srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2_hu5c60cd8225cab4ddf52eeef82d4311e9_26128_400x0_resize_box_3.png 400w" src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/assign-app-roles-2.png width=949 height=372></noscript></figure></p></li><li><p>On the next screen, you can select one or more users/groups, select an App role and click on the <code>Assign</code> button to assign the role the the specified users/groups.</p></li></ul><h2 id=create-the-client-application-registration>Create the Client Application Registration <a href=#create-the-client-application-registration class=anchor aria-hidden=true>#</a></h2><ul><li><p>Go back again to the <a href=https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade>Azure Active Directory blade</a> and under <code>Manage</code>, click on <code>App registrations</code>, and click the <code>New registration</code> button on top again.</p></li><li><p>This time, fill out <code>FSHClient</code> as Name, choose again for <code>Accounts in any organizational directory - Multitenant</code> and under <code>Redirect URI</code>, select <code>Single-page application (SPA)</code> and fill out the url <code>https://localhost:5001/swagger/oauth2-redirect.html</code>. Click on <code>Register</code>:<figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_20x0_resize_box_3.png data-srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_400x0_resize_box_3.png 400w" width=845 height=566><noscript><img class=img-fluid sizes=100vw srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api_huba62a80f5866c3c5b151606978986318_23568_400x0_resize_box_3.png 400w" src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/register-api.png width=845 height=566></noscript></figure></p></li></ul><h3 id=add-permission-for-the-api>Add permission for the Api <a href=#add-permission-for-the-api class=anchor aria-hidden=true>#</a></h3><ul><li><p>On the newly created App&rsquo;s blade, under <code>Manage</code>, click on <code>API permissions</code> and click the <code>Add a permission</code> button:<figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_20x0_resize_box_3.png data-srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_400x0_resize_box_3.png 400w" width=853 height=505><noscript><img class=img-fluid sizes=100vw srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1_huf5ede30cd27b35b526e6f408879be87c_37110_400x0_resize_box_3.png 400w" src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-1.png width=853 height=505></noscript></figure></p></li><li><p>On the next view, under <code>Select an API</code>, click on <code>My APIs</code> and select FSHApi:<figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_20x0_resize_box_3.png data-srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_400x0_resize_box_3.png 400w" width=857 height=269><noscript><img class=img-fluid sizes=100vw srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2_hu232695f53cd07a72c58a87c2b951d412_12024_400x0_resize_box_3.png 400w" src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-2.png width=857 height=269></noscript></figure></p></li><li><p>Then, under <code>Select permissions</code>, check the <code>access_as_user</code> permission and click on <code>Add permissions</code>:<figure><img class="img-fluid lazyload blur-up" data-sizes=auto src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_20x0_resize_box_3.png data-srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_400x0_resize_box_3.png 400w" width=838 height=445><noscript><img class=img-fluid sizes=100vw srcset="/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_2000x0_resize_box_3.png 2000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_1000x0_resize_box_3.png 1000w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_900x0_resize_box_3.png 900w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_800x0_resize_box_3.png 800w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_700x0_resize_box_3.png 700w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_600x0_resize_box_3.png 600w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_500x0_resize_box_3.png 500w,/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3_hu1c11613c3945c17016838b1d67dcadcb_17877_400x0_resize_box_3.png 400w" src=/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/add-permission-3.png width=838 height=445></noscript></figure></p></li></ul><h3 id=add-blazor-client-application>Add Blazor Client application <a href=#add-blazor-client-application class=anchor aria-hidden=true>#</a></h3><p>This should be enough for testing from swagger. But you&rsquo;ll probably will want to use the client application as well. There&rsquo;s 2 options here. Or you can add the <code>Redirect URI</code> for the client application to the same App registration you just created (click on <code>Authentication</code> under <code>Manage</code> and then on <code>Add URI</code>), or you can create a whole new client app registration specifically for this client, just like described in the steps above, but with another <code>Redirect URI</code>. In any case, the <code>Redirect URI</code> for the blazor app you will want to use is <code>https://localhost:5002/authentication/login-callback</code>.</p><h2 id=update-the-azuread-settings-on-the-web-api-project>Update the AzureAd settings on the Web Api project <a href=#update-the-azuread-settings-on-the-web-api-project class=anchor aria-hidden=true>#</a></h2><p>Now that&rsquo;s all set up, the only thing left is updating the configuration to use AzureAd.
On the Web API project, under <code>src\Host\Configurations</code>, open <code>security.json</code> and fill out the required settings:</p><ul><li><code>Provider</code>: set to <code>AzureAd</code></li><li><code>Instance</code>: set to <code>https://login.microsoftonline.com/</code></li><li><code>Domain</code>: you can find your domain in the Azure Active Directory blade on the <code>Overview</code> page under <code>Primary domain</code>.</li><li><code>TenantId</code>: set to <code>organizations</code></li><li><code>ClientId</code>: set to the <code>Application (client) ID</code> of the FSHApi App registration (you can find this on the <code>Overview</code> page of the App registration in Azure)</li><li><code>Scopes</code>: set to <code>access_as_user</code></li><li><code>RootIssuer</code>: set to <code>https://sts.windows.net/&lt;Your Tenant ID>/</code> (your <code>Tenant ID</code> is also on the <code>Overview</code> page of the Azure Active Directory blade)</li></ul><p>Then for swagger to work you need the following settings under the <code>Swagger</code> node in <code>security.json</code>:</p><ul><li><code>AuthorizationUrl</code>: set to <code>https://login.microsoftonline.com/organizations/oauth2/v2.0/authorize</code></li><li><code>TokenUrl</code>: set to <code>https://login.microsoftonline.com/organizations/oauth2/v2.0/token</code></li><li><code>ApiScope</code>: set to the full name of the api scope we created in the FSHApi App registration above (<code>api://&lt;ClientId of the FSHApi App registration>/access_as_user</code>)</li><li><code>OpenIdClientId</code>: set to the <code>Application (client) ID</code> of the FSHClient App registration (or the one you specifically created for swagger).</li></ul><h2 id=update-the-azuread-settings-on-the-blazor-client-project>Update the AzureAd settings on the Blazor Client project <a href=#update-the-azuread-settings-on-the-blazor-client-project class=anchor aria-hidden=true>#</a></h2><p>Then for the blazor client to work, you need the following settings over there in the <code>wwwroot/appsettings.json</code> file:</p><ul><li><code>AuthProvider</code>: set to <code>AzureAd</code></li><li><code>Authority</code>: set to <code>https://login.microsoftonline.com/organizations</code></li><li><code>ClientId</code>: set to the <code>Application (client) ID</code> of the FSHClient App registration (or the one you specifically created for the blazor client).</li><li><code>ValidateAuthority</code>: set to <code>true</code></li><li><code>ApiScope</code>: set to the full name of the api scope we created in the FSHApi App registration (<code>api://&lt;ClientId of the FSHApi App registration>/access_as_user</code>) same as before with the swagger client.</li></ul><h2 id=configuration-for-postman>Configuration for Postman <a href=#configuration-for-postman class=anchor aria-hidden=true>#</a></h2><p>TODO - Coming soon</p><h2 id=test-it-out>Test it out <a href=#test-it-out class=anchor aria-hidden=true>#</a></h2><ul><li><p>Start the Web API project and browse to <code>https://localhost:5001/swagger</code> when you click on the <code>Authorize</code> button on the top right, you should be redirected to the Microsoft login site. Log in with a user to which you granted app roles and you should be redirected back to swagger with the padlock closed. When you now issue an api call, the Authorization header should be sent with the bearer token received from AzureAd.</p></li><li><p>Start the Blazor Client project and browse to <code>https://localhost:5002/</code>. You should be immediately redirected to the Microsoft login site. And after logging in, you should be redirected back to the homepage of the blazor client.</p></li></ul><h2 id=azuread-and-multitenancy>AzureAd and multitenancy <a href=#azuread-and-multitenancy class=anchor aria-hidden=true>#</a></h2><p>About the <code>RootIssuer</code>setting in <code>security.json</code>. This should be set to the issuer of the root tenant in AzureAd. When someone is logging in from that AzureAD tenant, the local root tenant will automatically be selected.</p><p>For the other tenants there&rsquo;s an &ldquo;issuer&rdquo; field in the tenants table to map those. There&rsquo;s still a part which has to be implemented for mutltiple tenants from AzureAd though, as there needs to be some kind of &ldquo;onboarding&rdquo; experience inside AzureAD when a new tenant needs access to you application. See https://docs.microsoft.com/en-us/azure/architecture/multitenant-identity/signup for more info about this.</p><h2 id=azuread-usersroles-vs-local-usersroles>AzureAd users/roles vs. local users/roles <a href=#azuread-usersroles-vs-local-usersroles class=anchor aria-hidden=true>#</a></h2><p>In any case, with AzureAd, when a user logs in and there doesn&rsquo;t exist a local user yet in the local tenant for that AzureAd user/tenant, one gets created automatically. It will also immediately have the same roles assigned like the ones in AzureAd. When an already existing user logs in and there are roles in AzureAd for that user which are not yet assigned to the local user, they will automatically be assigned. Currently there will never be any roles removed from a user. So removing the role assignment from AzureAd will not automatically remove it from the local user when he logs in. This to allow for people to use the role/permission management inside the app without having to do it in Azure.</p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=last-modified><a href=https://github.com/fullstackhero/docs/commit/129815808f52f35889b8bd195b3cbb38190af81d><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Last modified on April 8, 2023</a></div><div class=edit-page><a href=https://github.com/fullstackhero/docs/blob/master/content/en/dotnet-webapi-boilerplate/tutorials/azure-ad-guide/index.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></div></div><div class="docs-navigation d-flex justify-content-between"><a href=/dotnet-webapi-boilerplate/tutorials/crud-guide/><div class="card my-1"><div class="card-body py-2">&larr; Performing CRUD Operations</div></div></a><a class=ms-auto href=/dotnet-webapi-boilerplate/tutorials/deploying-to-iis/><div class="card my-1"><div class="card-body py-2">Deploying to IIS &rarr;</div></div></a></div><section class="section section-sm bg-light support-card"><h4 style=margin:5px>Like fullstackhero? ‚ù§Ô∏è</h4><p>Here is what you can do to show your support!</p><a class="btn btn-primary btn-lg px-4 mb-2" style=font-size:medium href=https://www.buymeacoffee.com/codewithmukesh target=_blank role=button>Buy me a Coffee ‚òï</a>
<a class="btn btn-primary btn-lg px-4 mb-2" style=font-size:medium href=https://opencollective.com/fullstackhero/contribute target=_blank role=button>Sponsor üòç</a></section></main></div></div></div><footer class="footer text-muted"><div class=container-fluid><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Developed & Maintained by <a href=https://www.codewithmukesh.com/>Mukesh Murugan</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item><a href=/privacy-policy/>Privacy</a></li></ul></div></div></div></footer><script src=/js/bootstrap.min.fdbe9b9ba88a036135318f3c721784d684ac9e3280fe282cc80d7d49f7f9c82780cd54228c1608685a230c09984300d7946fc471734d566fcebc148b65bd16db.js integrity="sha512-/b6bm6iKA2E1MY88cheE1oSsnjKA/igsyA19Sff5yCeAzVQijBYIaFojDAmYQwDXlG/EcXNNVm/OvBSLZb0W2w==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.451fe6185924dcedf55c767559b5130f666f31c989f0078a75bafc346ad7364e180edfd731b1ca6bae0e90dfee88842885d284126ab0879f5067399e3a02b09e.js integrity="sha512-RR/mGFkk3O31XHZ1WbUTD2ZvMcmJ8AeKdbr8NGrXNk4YDt/XMbHKa64OkN/uiIQohdKEEmqwh59QZzmeOgKwng==" crossorigin=anonymous defer></script>
<script src=/main.min.38d0314dc1a194d6418e58bdcbf6ad70fa7878b7a419460f5227188ee765af1eaded8b5a223b46dcca95ae582f0f29cb0e048a0fb19a450afe95c61072deac6e.js integrity="sha512-ONAxTcGhlNZBjli9y/atcPp4eLekGUYPUicYjudlrx6t7YtaIjtG3MqVrlgvDynLDgSKD7GaRQr+lcYQct6sbg==" crossorigin=anonymous defer></script>
<script src=/index.min.cf7147277539c69ab81f74b7af2e480398c659e673edfa4ff2ba371e398ba1ed06158f599ab2681f20f37f9ae7eaab12ecc3b43aa43616ad1a5c7e6cfdac7fb7.js integrity="sha512-z3FHJ3U5xpq4H3S3ry5IA5jGWeZz7fpP8ro3HjmLoe0GFY9ZmrJoHyDzf5rn6qsS7MO0OqQ2Fq0aXH5s/ax/tw==" crossorigin=anonymous defer></script>
<script data-name=BMC-Widget data-cfasync=false src=https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js data-id=codewithmukesh data-description="Support me on Buy me a coffee!" data-message data-color=#65bf96 data-position=Right data-x_margin=18 data-y_margin=18></script></body></html>